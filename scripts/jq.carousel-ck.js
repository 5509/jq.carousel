/**
 * jq.carousele
 *
 * @version      0.2
 * @author       nori (norimania@gmail.com)
 * @copyright    5509 (http://5509.me/)
 * @license      The MIT License
 * @link         https://github.com/5509/jq.carousel
 *
 * 2012-02-24 16:55
 */(function(a,b){function d(a,c){var d=b,g=f(c.namespace),h=b;for(d in c){if(typeof c[d]!="function"||/(?:^_)|(?:^handleEvent$)|(?:^init$)/.test(d))continue;h=g+e(d);a[h]=function(){var a=d;return function(b){return c[a](b)}}()}}function e(a){return a.replace(/(^[a-z])/,function(a){return a.toUpperCase()})}function f(a){return a.replace(/(^[A-Z])/,function(a){return a.toLowerCase()})}function g(a,c){var d=0,e=b;/^\d+$/.test(a)&&(a=new Array(a));e=a.length;for(;d<e;d+=1)c.apply(a[d],[d].concat(arguments))}var c=function(a,b){this.namespace="Carousel";return this instanceof c?this.init(a,b):new c(a,b)};c.prototype={init:function(c,d){var e=this,f=b;e.conf=a.extend({type:"horizontal",easing:"swing",move:1,duration:.2},d);e.$elem=c;e.$carousel_wrap=a("<div></div>");e.view_width=c[0].offsetWidth;e.total_width=0;e.current_item=0;e.$items=c.find(".carousel_box");e.items_length=e.$items.length;e.items_len_hidden=0;e.$elem.append(e.$carousel_wrap.append(e.$items));g(e.$items,function(b){var c=this;c.carousel_id=b;c.$elem=a(this);c.data_width=c.offsetWidth;c.origWidth=c.$elem.css("width");c.$elem.css({"float":"left"});if(e.items_len_hidden>e.view_width)return;e.items_len_hidden=e.items_len_hidden+c.data_width});e.item_width=e.$items.eq(0)[0].data_width;e.items_len_hidden=e.items_len_hidden/e.item_width;e._cloneItem();e.$elem.css({overflow:"hidden"});e.current_pos=-e.items_len_hidden*e.item_width;e.$carousel_wrap.css({marginLeft:e.current_pos+"px",height:e.$items.eq(0)[0].offsetHeight});e.$items=e.$carousel_wrap.find(".carousel_box");e._setWidth();e.$elem.trigger("carousel.ready");return e},_eventify:function(){var a=this},_cloneItem:function(){var a=this,b=a.items_len_hidden,c=a.$items.flexnth("<",b).reverse(),d=a.$items.flexnth(">",b).reverse();g(c,function(){a.$items.eq(a.$items.length-1).after(this)});g(d,function(){a.$items.eq(0).before(this)})},_setPosition:function(){var a=this},_getWidth:function(a){var b=this,c=b.$elem.find(".carousel_box");b.total_width=0;g(c,function(a){var c=this;c.data_width=c.offsetWidth;b.total_width=b.total_width+c.data_width})},_setWidth:function(){var a=this;a._getWidth();a.$carousel_wrap.css({width:a.total_width})},_getNext:function(a){var b=this;a>0?a+1>=b.item_length-1?a=0:a+=1:a+1<=0?a=b.item_length-1:a+=1;return a},_toNext:function(){var a=this,c=a.conf,d=a.items_len_hidden,e=a._getNext(1),f=b,g={};f=a.$carousel_wrap.animate({marginLeft:"-="+a.item_width},{queue:!1,easing:c.easing,duration:c.duration*1e3})},_toPrev:function(){var a=this,c=a.conf,d=a.items_len_hidden,e=a._getNext(-1),f=b,g={};a.$carousel_wrap.animate({marginLeft:"+="+a.item_width},{queue:!1,easing:c.easing,duration:c.duration*1e3})},_hold:function(){},prev:function(){var a=this;a._toPrev()},next:function(){var a=this;a._toNext()},go:function(a){}};a.fn.flexnth=function(b,c){var d,e=this,f=[];for(d=0;d<c;d++){if(d===c)break;f.push(e.eq(b!=="<"?e.length-(1+d):d).clone())}return a(f)};a.fn.reverse=function(){var b=[];a.each(this,function(a,c){b.unshift(c.clone())});return a(b)};jQuery.carousel=c;jQuery.fn.carousel=function(a){var b=c(this,a);d(this,b);return this}})(jQuery);